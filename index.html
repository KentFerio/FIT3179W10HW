<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Population & Immigration Trends</title>
  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
</head>
<body style="background-color:#f9f9f9; font-family:sans-serif;">
  <h1 style="text-align:center;">Population & Immigration Trends</h1>

  <div style="display:flex; justify-content:space-around; align-items:flex-start;">
    <div id="vis1"></div>
    <div id="vis2"></div>
  </div>

  <!-- Filter at the bottom -->
  <div style="text-align:center; margin-top:20px;">
    <label for="stateSelect"><b>Select State:</b></label>
    <select id="stateSelect">
      <option value="All">All</option>
      <option value="New South Wales">New South Wales</option>
      <option value="Victoria">Victoria</option>
      <option value="Queensland">Queensland</option>
      <option value="South Australia">South Australia</option>
      <option value="Western Australia">Western Australia</option>
      <option value="Tasmania">Tasmania</option>
      <option value="Northern Territory">Northern Territory</option>
      <option value="Australian Capital Territory">Australian Capital Territory</option>
    </select>
  </div>

  <script type="text/javascript">
    let selectedState = "All";

    // Embed both charts
    Promise.all([
      vegaEmbed('#vis1', 'population.json'),
      vegaEmbed('#vis2', 'immigrant.json')
    ]).then(results => {
      const [popView, immView] = results.map(r => r.view);

      // Add event listener for dropdown
      document.getElementById('stateSelect').addEventListener('change', function(e) {
        selectedState = e.target.value;
        popView.signal('selected_state', selectedState).run();
        immView.signal('selected_state', selectedState).run();
      });
    }).catch(console.error);
  </script>
</body>
</html>
